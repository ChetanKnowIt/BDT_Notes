<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to Concurrency</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="Introduction%20to%20Concurrency_files/default.css">
<link rel="stylesheet" type="text/css" href="Introduction%20to%20Concurrency_files/prettify.css">
<link href="Introduction%20to%20Concurrency_files/css.css" rel="stylesheet">
<script src="Introduction%20to%20Concurrency_files/prettify.js"></script>
<style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style id="MJX-SVG-styles">
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}
</style></head>
  <body class="coursenotes">
    <script>onload = function () {prettyPrint();}</script>
    <div class="container">
      <div class="innercontent">
        <h1>Introduction to Concurrency</h1>

<script>MathJax = {tex: {inlineMath: [['$', '$']]},svg: {fontCache: 'global'}};</script><script type="text/javascript" id="MathJax-script" async="" src="Introduction%20to%20Concurrency_files/tex-svg.js"></script>
<div class="abstract">Alan Kay said OOP, as he envisioned it, was <a href="http://userpage.fu-berlin.de/~ram/pub/pub_jf47ht81Ht/doc_kay_oop_en">more about messaging than anything else</a>.
 He's right. Computer scientists should have good mental models, and 
good programming models, for how objects behave and how they communicate
 with each other.
</div><div id="contents"><div>CONTENTS</div><div>Examples of Concurrency
 • Modeling Concurrency • Definitions • Why Study Concurrency? • 
Challenges • Concerns • Further Reading • Summary</div></div>
<h2>Examples of Concurrency</h2>

<p>The real world contains <dfn>actors</dfn> that execute independently 
of, but communicate with, each other. In modeling the world, many 
parallel executions have to be composed and coordinated, and that's 
where the study of <dfn>concurrency</dfn> comes in. Consider:</p>
<ul>
  <li>Railway Networks (note shared sections of track)
  </li><li>Gardening (people rake, sweep, mow, plant, etc.)
  </li><li>Machines in a factory
  </li><li>Banking systems
  </li><li>Travel reservation systems
  </li><li>Multiplayer games
  </li><li>Well coordinated teams or societies (<a href="http://en.rocketnews24.com/2014/11/19/1200-japanese-workers-convert-above-ground-train-to-subway-line-in-a-matter-of-hours/">Awesome example</a>)
  </li><li>Your daily routines (are you good at <em>multitasking</em>?)
  </li><li>The brain — the mind, really — as shown in Minsky’s
  <a href="http://www.amazon.com/The-Society-Mind-Marvin-Minsky/dp/0671657135">Society
  of Mind</a>
</li></ul>

<p>Hardware examples:</p>
<ul>
  <li>A single processor can have multiple execution pipelines (but only one set of registers)
  </li><li>A processor can have multiple cores (multicore)
  </li><li>A computer can have multiple processors
  </li><li>A network can have multiple computers (Grid computing happens on these)
  </li><li>An internet has multiple networks
  </li><li>All combinations of the above
</li></ul>

<p>Software examples:</p>
<ul>
  <li>Multiprogramming, or running a lot of programs concurrently (the O.S. has to
  multiplex their execution on available processors). For example:
    <ul>
      <li>downloading a file
      </li><li>listening to streaming audio
      </li><li>having a clock running
      </li><li>chatting
      </li><li>analyzing data from some weird experiment
      </li><li>streaming a movie
      </li><li>printing something
      </li><li>running a simulation
      </li><li>typing in a text editor
      </li><li>running a web server, sendmail, and other daemons
    </li></ul>
  </li><li>Simulation programs
  </li><li>High volume servers (multiple clients are serviced at the same time
  (possibly in parallel, possibly with interleaved execution) to give
  the appearance of responsiveness)
  </li><li>Pipes - for example
<pre class="console">$ <kbd>sort | uniq | format | print</kbd>
</pre>
  </li>
</ul>

<p>Even more examples:</p>
<ul>
<li>The expression <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="0"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="17.99ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 7951.4 1083.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(389,0)"><use data-c="1D44E" xlink:href="#MJX-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(918,0)"><use data-c="1D44F" xlink:href="#MJX-TEX-I-1D44F"></use></g><g data-mml-node="mo" transform="translate(1569.2,0)"><use data-c="2B" xlink:href="#MJX-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(2569.4,0)"><use data-c="1D450" xlink:href="#MJX-TEX-I-1D450"></use></g><g data-mml-node="msup" transform="translate(3002.4,0)"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-TEX-I-1D451"></use></g><g data-mml-node="mn" transform="translate(553,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(3959,0)"><use data-c="29" xlink:href="#MJX-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(4348,0)"><use data-c="28" xlink:href="#MJX-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(4737,0)"><use data-c="1D454" xlink:href="#MJX-TEX-I-1D454"></use></g><g data-mml-node="mo" transform="translate(5436.2,0)"><use data-c="2B" xlink:href="#MJX-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(6436.4,0)"><use data-c="1D453" xlink:href="#MJX-TEX-I-1D453"></use></g><g data-mml-node="mi" transform="translate(6986.4,0)"><use data-c="210E" xlink:href="#MJX-TEX-I-210E"></use></g><g data-mml-node="mo" transform="translate(7562.4,0)"><use data-c="29" xlink:href="#MJX-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>a</mi><mi>b</mi><mo>+</mo><mi>c</mi><msup><mi>d</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>g</mi><mo>+</mo><mi>f</mi><mi>h</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container> can be evaluated in four clocks:
<p><img src="Introduction%20to%20Concurrency_files/parexp.png" alt="parexp.png"></p></li><li>Many algorithms can be broken up into concurrent parts:
  <ul>
    <li>Mergesort
    </li><li>Quicksort
    </li><li>Summing a list by summing fragments in parallel
    </li><li>Operating on independent slices of an array
<pre class="prettyprint lang-ada"><span class="pln">&nbsp; &nbsp; </span><span class="com">-- Each of the K processors or execution units can work on the</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">-- code below for a specific value for I, so the loop can</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">-- be executed in ceil(N/K) "steps".</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> I </span><span class="kwd">in</span><span class="pln"> </span><span class="lit">1</span><span class="pun">..</span><span class="pln">N </span><span class="kwd">loop</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; D</span><span class="pun">[</span><span class="pln">I</span><span class="pun">]</span><span class="pln"> </span><span class="pun">:=</span><span class="pln"> A</span><span class="pun">[</span><span class="pln">I</span><span class="pun">]</span><span class="pln"> &nbsp;</span><span class="pun">+</span><span class="pln"> B</span><span class="pun">[</span><span class="pln">I</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> C</span><span class="pun">[</span><span class="pln">I</span><span class="pun">]</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">end</span><span class="pln"> </span><span class="kwd">loop</span></pre></li>
    <li>Computing primes
    </li><li>Checking equality of leaf sequences in trees
    </li><li>Computing <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="1"><svg style="vertical-align: -0.798ex;" xmlns="http://www.w3.org/2000/svg" width="3.032ex" height="2.72ex" role="img" focusable="false" viewBox="0 -849.5 1340.3 1202.3" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mrow"><g data-mml-node="TeXAtom" data-mjx-texclass="OPEN"><g data-mml-node="mo" transform="translate(0 -0.5)"><use data-c="28" xlink:href="#MJX-TEX-SO-28"></use></g></g><g data-mml-node="mfrac" transform="translate(458,0)"><g data-mml-node="mi" transform="translate(0,444) scale(0.707)"><use data-c="1D45B" xlink:href="#MJX-TEX-I-1D45B"></use></g><g data-mml-node="mi" transform="translate(27.9,-345) scale(0.707)"><use data-c="1D458" xlink:href="#MJX-TEX-I-1D458"></use></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="CLOSE" transform="translate(882.3,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><use data-c="29" xlink:href="#MJX-TEX-SO-29"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mrow data-mjx-texclass="OPEN"><mo minsize="1.2em" maxsize="1.2em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mi>k</mi></mfrac><mrow data-mjx-texclass="CLOSE"><mo minsize="1.2em" maxsize="1.2em">)</mo></mrow></mrow></math></mjx-assistive-mml></mjx-container>
  </li></ul>
</li></ul>


<h2>Modeling Concurrency</h2>

<h3>Architecture</h3>

<p>I’m going to go out on a limb and suggest that there are three major styles of architecting a concurrent system.</p>
<div class="sticky">
<div style="width:11em;height:14em"><h6>Distributed</h6><p>Multiple independent processes with <span class="lite">no shared memory</span>, communicating only via <strong>message passing</strong>.</p></div>
<div style="width:11em;height:14em"><h6>Multi-<br>Threaded</h6><p><span class="lite">Multiple threads share memory</span>, so require <strong>locks</strong>. Generally, a single process can have multiple threads.</p></div>
<div style="width:11em;height:14em"><h6>Event<br>Queue</h6><p>One a <span class="lite">single thread</span> exists! A single loop reads from the event queue and invokes the handlers.</p></div>
</div>

<p>Probably some mixing can occur.</p>

<p>The “threads vs. events” issue is a big one. Which is better? Or when is one better than the other, if ever?
Read this <a href="http://berb.github.io/diploma-thesis/original/043_threadsevents.html">neutral
analysis of both styles</a>.</p>

<p>Generally speaking, threading requires that you use, locks, mutexes, 
countdowns, condition variables, semaphores, and similar things. But 
there do exist higher-level synchronization mechanisms like monitors and
 Ada-style protected objects.</p>

<h3>Agents</h3>

<p>In a distributed system, the processes can be considered to have a 
life of their own, in which case we sometimes call them actors or 
agents. High-level models for the agents include:</p>
<div class="sticky">
<div style="width:10em"><h6>Actors</h6><p>Communicate with each other via <b>mailboxes</b></p></div>
<div style="width:10em"><h6>Goroutines</h6><p>Communicate with each other via <b>channels</b></p></div>
<div style="width:10em"><h6>Coroutines</h6><p>Communicate by <b>yielding</b> to each other</p></div>
</div>

<h3>Theory</h3>

<p>As always, a theory (organized body of knowledge with predictive 
powers) helps use understand the state of the art and enables growth. 
People have created a number of <a href="https://en.wikipedia.org/wiki/Process_calculus">process algebras</a> and process calculi to describe concurrent systems mathematically.</p>

<div class="exercise"><b>Exercise</b>: Read the linked article.
</div>
<h2>Definitions</h2>

<p>As always, a working vocabulary helps.</p>

<h3>The Concrete</h3>

<dl>
  <dt>Program
  </dt><dd>The source code for a process or processes.
  </dd><dt>Process
  </dt><dd>A unit of program execution as seen by an operating system.
      Processes tend to act like they are the only thing
      running. A process has its own address space, file
      handles, security attributes, threads, etc.
      The operating system prevents processes from messing
      with each other.
  </dd><dt>Thread
  </dt><dd>A sequential flow of control within a process.
      A process can contain one or more threads.
      Threads have their own program counter and register
      values, but they share the memory space and
      other resources of the process.
  </dd><dt>Multiprogramming / Multiprocessing
  </dt><dd>Concurrent execution of several programs on one computer.
  </dd><dt>Multithreading
  </dt><dd>Execution of a program with multiple threads.
</dd></dl>

<h3>The Abstract</h3>

<dl>
  <dt>Parallelism
  </dt><dd>Truly simultaneous execution or evaluation of things.
  </dd><dt>Concurrency
  </dt><dd>The coordination and management of independent lines of execution.
      These executions can be truly parallel or simply be managed by interleaving.
      They can communicate via shared memory or message passing.
      (Rob Pike's definition: “the composition”dependently executing
      computations”)
  </dd><dt>Distribution
  </dt><dd>Concurrency in which <em>all</em> communication is via message passing
      (useful because shared memory communication doesn’t scale
      to thousands of processors).
</dd></dl>

<h3>The Pragmatic</h3>

<dl>
  <dt>Concurrent Programming
  </dt><dd>Solving a single problem by breaking it down into concurrently
      executing processes or threads.
  </dd><dt>Shared Resource
  </dt><dd>An entity used by more than one thread but one that “should”
      can only be operated on by one thread at a time.
  </dd><dt>Synchronization
  </dt><dd>The act of threads agreeing to coordinate their behavior
      in order to solve a problem correctly. (This usually means
      that thread <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="2"><svg style="vertical-align: 0px;" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" role="img" focusable="false" viewBox="0 -716 750 716" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D434" xlink:href="#MJX-TEX-I-1D434"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container> will block and wait until thread <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="3"><svg style="vertical-align: 0px;" xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 759 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D435" xlink:href="#MJX-TEX-I-1D435"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></mjx-assistive-mml></mjx-container> performs
      some operation.)
</dd></dl>


<h2>Why Study Concurrency?</h2>

<p>Because reasons.</p>

<ul class="spaced">
  <li><strong>Modeling</strong>. Real world systems are naturally concurrent, we do often care about modeling the real world.</li>
  <li><strong>Usefulness</strong>. Concurrency is useful in multicore, multiprocessor and distributed computer systems.
    <ul class="compressed">
      <li>Increased performance from true parallelism
      </li><li>Increased reliability (fault tolerance)
      </li><li>Specialized processors (graphics, communication, encryption ...)
    </li></ul>
  </li>
  <li><strong>Necessity</strong> Some applications, like email, are inherently distributed; we cannot write them any other way.</li>
  <li><strong>Superior Program Structure</strong>. We can write code for the different tasks and let some
 <em>separate</em> engine schedule the tasks.
  <div class="example"><b>Example</b>: It's nice when writing
  code to mine data, analyze telemetry, write massive files to disk, or
  produce frames for a movie, to not have to chunk up your code and
  shove in checks for the keyboard and mouse and other devices.</div>

  <div class="example"><b>Example</b>: When writing
  a word processor, it's a lot simpler to write separate threads for
    <ul class="compressed">
      <li>reading keystrokes and collecting characters into words
      </li><li>collecting words to fill a line
      </li><li>hyphenating where necessary
      </li><li>adding spacing to justify with right margin
      </li><li>inserting page breaks where necessary
      </li><li>checking spelling
      </li><li>saving (periodically)
    </li></ul>
  (<em>One difficulty in doing this sequentially is that "hyphenation
  requires a portion of the word to be returned to the stream
  of words to await the next line" [Ben-Ari, 1990].</em>)
  </div>
  </li>
</ul>

<h2>Challenges</h2>

<p>Naturally, concurrent programming is harder than sequential programming
because concurrent programming is about writing a bunch of communicating
sequential programs. You end up with a bunch of problems that don’t
exist in sequential programs:</p>
<ul>
  <li>How do you get concurrent threads to <b>synchronize</b>
      when necessary so they don't make a mess of <b>shared
      resources</b>?
  </li><li>How do you avoid <b>race conditions</b>,
      <b>deadlock</b>, and <b>starvation</b>?
  </li><li>How do you ensure <b>safety</b> and
      <b>liveness</b>?
  </li><li>How do you prove these nasty things <b>partially
      correct</b>? <b>Totally correct</b>?
  </li><li>How do you partition the code into threads, or partition the
      processes on processors so that everything runs
      <b>efficiently</b>?
  </li><li>How do you recover if one of the nodes in a distributed system
      <b>fails?</b> (Fault tolerance)
</li></ul>
<p>Single-threaded event-based systems have issues, too. You need to
make sure each chunk of code (responses to events) always run quickly
and leave everything in a consistent state.</p>

<h2>Concerns</h2>

<p>The field of concurrent programming is concerned with:</p>
<ul>
  <li>Modeling
  </li><li>Granularity
  </li><li>Scheduling
  </li><li>Communication
  </li><li>Synchronization
  </li><li>Language Integration
  </li><li>Implementation
</li></ul>
<p>A brief introduction of each follows.</p>

<h3>Modeling</h3>

<p>We need a formal way to talk about concurrent programming
so that we can analyze requirements and design and implement
correct and efficient algorithms. One of the most useful models
used in reasoning about concurrent programs is the <b>non-realtime
interleaved execution model</b>. This is:</p>

<blockquote>The study of interleaved execution sequences of
atomic instructions, where each of the instructions
execute in a completely arbitrary but finite amount
of time.</blockquote>

<p>In this model we can make <em>no</em> assumptions at all about
the relative speeds of the individual instructions, or how
malicious a scheduler might be. Since instructions take
arbitrary time, there can be many possible interleavings.</p>

<p><b>Example</b>: Suppose thread-1 has instruction sequence
<mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="4"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.403ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3714.3 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D434" xlink:href="#MJX-TEX-I-1D434"></use></g><g data-mml-node="mo" transform="translate(1028,0)"><use data-c="2C" xlink:href="#MJX-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(1472.7,0)"><use data-c="1D435" xlink:href="#MJX-TEX-I-1D435"></use></g><g data-mml-node="mo" transform="translate(2231.7,0)"><use data-c="2C" xlink:href="#MJX-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(2676.3,0)"><use data-c="1D436" xlink:href="#MJX-TEX-I-1D436"></use></g><g data-mml-node="mo" transform="translate(3436.3,0)"><use data-c="5D" xlink:href="#MJX-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>C</mi><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container> and thread-2 has sequence <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="5"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.667ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2062.7 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D465" xlink:href="#MJX-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(850,0)"><use data-c="2C" xlink:href="#MJX-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(1294.7,0)"><use data-c="1D466" xlink:href="#MJX-TEX-I-1D466"></use></g><g data-mml-node="mo" transform="translate(1784.7,0)"><use data-c="5D" xlink:href="#MJX-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container>. Then we have to consider:</p>

<pre>   [A B C x y]
   [A B x C y]
   [A B x y C]
   [A x B C y]
   [A x B y C]
   [A x y B C]
   [x A B C y]
   [x A B y C]
   [x A y B C]
   [x y A B C]
</pre>

<div class="exercise"><b>Exercise</b>:
Write out all interleavings of two threads, the first
with sequence <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="6"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.403ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3714.3 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D434" xlink:href="#MJX-TEX-I-1D434"></use></g><g data-mml-node="mo" transform="translate(1028,0)"><use data-c="2C" xlink:href="#MJX-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(1472.7,0)"><use data-c="1D435" xlink:href="#MJX-TEX-I-1D435"></use></g><g data-mml-node="mo" transform="translate(2231.7,0)"><use data-c="2C" xlink:href="#MJX-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(2676.3,0)"><use data-c="1D436" xlink:href="#MJX-TEX-I-1D436"></use></g><g data-mml-node="mo" transform="translate(3436.3,0)"><use data-c="5D" xlink:href="#MJX-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>C</mi><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container> and the second with <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="7"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.725ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2972.3 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D465" xlink:href="#MJX-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(850,0)"><use data-c="2C" xlink:href="#MJX-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(1294.7,0)"><use data-c="1D466" xlink:href="#MJX-TEX-I-1D466"></use></g><g data-mml-node="mo" transform="translate(1784.7,0)"><use data-c="2C" xlink:href="#MJX-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(2229.3,0)"><use data-c="1D467" xlink:href="#MJX-TEX-I-1D467"></use></g><g data-mml-node="mo" transform="translate(2694.3,0)"><use data-c="5D" xlink:href="#MJX-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container>.</div>

<p>The number of interleavings for two threads, one with
<mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="8"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.986ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 878 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-TEX-I-1D45A"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container> instructions and one with
<mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="9"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-TEX-I-1D45B"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container> instructions is <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="10"><svg style="vertical-align: -0.798ex;" xmlns="http://www.w3.org/2000/svg" width="5.682ex" height="2.735ex" role="img" focusable="false" viewBox="0 -856.2 2511.2 1209" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mrow"><g data-mml-node="TeXAtom" data-mjx-texclass="OPEN"><g data-mml-node="mo" transform="translate(0 -0.5)"><use data-c="28" xlink:href="#MJX-TEX-SO-28"></use></g></g><g data-mml-node="mfrac" transform="translate(458,0)"><g data-mml-node="mrow" transform="translate(0,444) scale(0.707)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-TEX-I-1D45A"></use></g><g data-mml-node="mo" transform="translate(878,0)"><use data-c="2B" xlink:href="#MJX-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(1656,0)"><use data-c="1D45B" xlink:href="#MJX-TEX-I-1D45B"></use></g></g><g data-mml-node="mi" transform="translate(585.5,-345) scale(0.707)"><use data-c="1D45B" xlink:href="#MJX-TEX-I-1D45B"></use></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="CLOSE" transform="translate(2053.2,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><use data-c="29" xlink:href="#MJX-TEX-SO-29"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mrow data-mjx-texclass="OPEN"><mo minsize="1.2em" maxsize="1.2em">(</mo></mrow><mfrac linethickness="0"><mrow><mi>m</mi><mo>+</mo><mi>n</mi></mrow><mi>n</mi></mfrac><mrow data-mjx-texclass="CLOSE"><mo minsize="1.2em" maxsize="1.2em">)</mo></mrow></mrow></math></mjx-assistive-mml></mjx-container>
— which
you probably know is
<mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="11"><svg style="vertical-align: -0.801ex;" xmlns="http://www.w3.org/2000/svg" width="6.294ex" height="3.17ex" role="img" focusable="false" viewBox="0 -1047.1 2781.9 1401.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mrow" transform="translate(220,516.8) scale(0.707)"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(389,0)"><use data-c="1D45B" xlink:href="#MJX-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(989,0)"><use data-c="2B" xlink:href="#MJX-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(1767,0)"><use data-c="1D45A" xlink:href="#MJX-TEX-I-1D45A"></use></g><g data-mml-node="mo" transform="translate(2645,0)"><use data-c="29" xlink:href="#MJX-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3034,0)"><use data-c="21" xlink:href="#MJX-TEX-N-21"></use></g></g><g data-mml-node="mrow" transform="translate(671.8,-346.3) scale(0.707)"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(600,0)"><use data-c="21" xlink:href="#MJX-TEX-N-21"></use></g><g data-mml-node="mi" transform="translate(878,0)"><use data-c="1D45A" xlink:href="#MJX-TEX-I-1D45A"></use></g><g data-mml-node="mo" transform="translate(1756,0)"><use data-c="21" xlink:href="#MJX-TEX-N-21"></use></g></g><rect width="2541.9" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo><mo>!</mo></mrow><mrow><mi>n</mi><mo>!</mo><mi>m</mi><mo>!</mo></mrow></mfrac></math></mjx-assistive-mml></mjx-container>.</p>

<div class="exercise"><b>Exercise</b>:
How many interleavings are possible with <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="12"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-TEX-I-1D45B"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container> threads
where thread <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="13"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.781ex" height="1.52ex" role="img" focusable="false" viewBox="0 -661 345 672" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-TEX-I-1D456"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container> has <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="14"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="1.918ex" height="1.927ex" role="img" focusable="false" viewBox="0 -694 848 851.8" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-TEX-I-1D458"></use></g><g data-mml-node="mi" transform="translate(554,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-TEX-I-1D456"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>k</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container> instructions?</div>

<h3>Granularity</h3>

<p>Systems can be classified by “where” the concurrency is expressed or implemented.</p>

<h4>Instruction Level</h4>

<p>Most processors have several execution units and can execute several 
instructions at the same time. Good compilers can reorder instructions 
to maximize instruction throughput. Often the processor itself can do 
this.</p>

<div class="example"><b>Example</b>: On the old (ancient) Pentium microprocessor, the instruction sequence:
<pre>    inc ebx
    inc ecx
    inc edx
    mov esi,[x]
    mov eax,[ebx]
</pre>

<p>would be executed as follows:</p>

<pre>    Step       U-pipe            V-pipe
    -----------------------------------------
      0        inc ebx           inc ecx
      1        inc edx           mov esi, [x]
      2        mov eax, [ebx]
</pre>
</div>

<p>Modern processors even parallelize execution of micro-steps of instructions within the same pipe.</p>

<h4>Statement Level</h4>

<p>Many programming languages have syntactic forms to express that 
statements should execute in sequence or in parallel. Common notations:</p>

<table>
<tbody><tr>
  <th>Pascal-style</th>
  <th>Occam-style</th>
  <th>Algebraic</th>
</tr>
<tr>
  <td>
<pre>begin
   A;
   cobegin
      B;
      C;
   coend
   D;
   cobegin
      E;
      F;
      G;
   coend
end
</pre>
  </td>
  <td>
<pre>SEQ
   a
   PAR
      b
      c
   d
   PAR
      e
      f
      g

</pre>
  </td>
  <td>
<pre>a ; b || c ; d ; e || f || g
</pre>
  </td>
</tr>
</tbody></table>

<h4>Procedure Level</h4>

<p>Many languages have a thread type (or class) and a means to run a function on a thread. These things might also be called <dfn>tasks</dfn>. Alternatively there might be a library call to spawn a thread and execute a function on the thread.</p>

<h4>Program Level</h4>

<p>The operating system runs processes concurrently. And this is cool: 
Many programming languages give you the ability to spawn processes from 
your program.</p>

<p>In Java:</p>
<pre class="prettyprint"><span class="typ">Runtime</span><span class="pun">.</span><span class="pln">getRuntime</span><span class="pun">().</span><span class="kwd">exec</span><span class="pun">(</span><em><span class="pln">commandline</span></em><span class="pun">);</span><span class="pln"><br></span><img src="Introduction%20to%20Concurrency_files/java-logo32.png" style="position:absolute;top:4px;right:4px"></pre>

<p>In Python:</p>
<p>TODO</p>

<p>In C, using the Win32 API:</p>
<pre class="prettyprint"><span class="typ">CreateProcess</span><span class="pun">(</span><span class="pln">security_attributes</span><span class="pun">,</span><span class="pln"> stack_size</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="kwd">function</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">param</span><span class="pun">,</span><span class="pln"> activation</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">thread_id</span><span class="pun">);</span><span class="pln"><br></span><img src="Introduction%20to%20Concurrency_files/C-logo32.png" style="position:absolute;top:4px;right:4px"></pre>

<div class="exercise">Exercise:
Show how to spawn a new process using the Unix system calls
<code>execve</code> with <code>fork</code>.)
</div>

<h3>Scheduling</h3>

<p>Generally you'll have <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="15"><svg style="vertical-align: 0px;" xmlns="http://www.w3.org/2000/svg" width="2.378ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 1051 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-TEX-I-1D440"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></mjx-assistive-mml></mjx-container> processors and <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="16"><svg style="vertical-align: 0px;" xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-TEX-I-1D441"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></mjx-assistive-mml></mjx-container> threads. If <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="17"><svg style="vertical-align: -0.09ex;" xmlns="http://www.w3.org/2000/svg" width="7.404ex" height="1.636ex" role="img" focusable="false" viewBox="0 -683 3272.6 723" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-TEX-I-1D440"></use></g><g data-mml-node="mo" transform="translate(1328.8,0)"><use data-c="3C" xlink:href="#MJX-TEX-N-3C"></use></g><g data-mml-node="mi" transform="translate(2384.6,0)"><use data-c="1D441" xlink:href="#MJX-TEX-I-1D441"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo>&lt;</mo><mi>N</mi></math></mjx-assistive-mml></mjx-container>
you need a <b>scheduler</b> to interleave execution.
A thread can be in one of several states; one example is:</p>

<p><img src="Introduction%20to%20Concurrency_files/threestatesched.png" alt="threestatesched.png"></p>
<div class="exercise"><b>Exercise</b>: Win32 threads have six states. What are they?
</div>
<h3>Communication</h3>

<p>The threads of control must communicate with each other. The two main
ways to communicate:</p>

<ul>
  <li><b>Shared Memory</b> (Indirect)
  </li><li><b>Message Passing</b> (Direct)
</li></ul>

<h3>Synchronization</h3>

<p>Threads sometimes have to coordinate their activities. Here is the
overused classic example: two threads <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="18"><svg style="vertical-align: 0px;" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" role="img" focusable="false" viewBox="0 -716 750 716" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D434" xlink:href="#MJX-TEX-I-1D434"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container> and <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="19"><svg style="vertical-align: 0px;" xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 759 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D435" xlink:href="#MJX-TEX-I-1D435"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></mjx-assistive-mml></mjx-container> are trying to make a $100 deposit.
They both execute the sequence:</p>

<ol>
  <li>Move the current value of the account into a register
  </li><li>Add 100 to the register
  </li><li>Write the value of the register back into memory
</li></ol>

<p>If A executes its first statement and then <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="20"><svg style="vertical-align: 0px;" xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 759 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D435" xlink:href="#MJX-TEX-I-1D435"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></mjx-assistive-mml></mjx-container> executes its first
statement before <mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" style="position: relative;" tabindex="0" ctxtmenu_counter="21"><svg style="vertical-align: 0px;" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" role="img" focusable="false" viewBox="0 -716 750 716" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D434" xlink:href="#MJX-TEX-I-1D434"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container> finishes its third statement, one of the deposits
gets lost. There are dozens of programming paradigms to make sure threads
can synchronize properly to avoid these problems. Roughly speaking, there
are two approaches. The code to define this “critical region”; might use explicit acquisition
and release of locks:</p>
<pre class="prettyprint lang-ruby"><span class="kwd">lock</span><span class="pln"> </span><span class="pun">:=</span><span class="pln"> acquire_a_lock</span><span class="pun">()</span><span class="pln"><br></span><span class="kwd">register</span><span class="pln"> </span><span class="pun">:=</span><span class="pln"> read_balance</span><span class="pun">()</span><span class="pln"><br></span><span class="kwd">register</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">100</span><span class="pln"><br>write_balance</span><span class="pun">(</span><span class="kwd">register</span><span class="pun">)</span><span class="pln"><br>release_lock</span><span class="pun">()</span></pre>
<p>or the synchronization may be more implicit:</p>
<pre class="prettyprint lang-ruby"><span class="pln">critical_section </span><span class="kwd">do</span><span class="pln"><br>&nbsp; </span><span class="kwd">register</span><span class="pln"> </span><span class="pun">:=</span><span class="pln"> read_balance</span><span class="pun">()</span><span class="pln"><br>&nbsp; </span><span class="kwd">register</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">100</span><span class="pln"><br>&nbsp; write_balance</span><span class="pun">(</span><span class="kwd">register</span><span class="pun">)</span><span class="pln"><br></span><span class="kwd">end</span></pre>


<h3>Temporal Constraints</h3>

<p>If a system has temporal constraints, such as “this operation ”complete
in 5 ms” it is called a <b>real-time system</b>. (Real-time constraints are
common in embedded systems.)</p>

<h3>Language Integration</h3>

<p>Many have argued whether a language should have direct
support for concurrency and distribution or whether such
support should come from a library.</p>

<table aria-label="Library or language-intrinsic concurrency">
<tbody><tr>
  <th>Library or O.S. based</th>
  <th>Language-Intrinsic</th>
</tr>

<tr>
<td>
<pre>.
.
.
int t1, t2;
.
.
.
t1 = createThread(myFunction);
.
.
.
start(t1);
    // now t1 runs in parallel
    // with the function that
    // called start().
    // Termination is
    // asynchronous, though
    // joining can be done with
    // a library call.
</pre>
</td>
<td>
<pre>procedure P is
   .
   .
   .
   task T;
   .
   .
   .
begin   -- T activated implicitly here
   .
   .
   .   -- T and P execute in parallel
   .
   .
end P;  -- T and P terminate together
</pre>
</td>
</tr>
<tr>
  <td>
    <p>Advantages:</p>
    <ul>
      <li>Because different languages have different models
      of concurrency, language interfacing (multi-lingual
      development) may be easier.
      </li><li>A specific language model may not fit well
      with a particular O.S.
      </li><li>O.S. standards (e.g. POSIX) exist anyway,
      so perhaps portability might be likely.
    </li></ul>
  </td>
  <td>
    <p>Advantages:</p>
    <ul>
      <li>Code likely to be more reliable and maintainable
      since constructs are high level.
      </li><li>Lots of different operating systems exist,
      so code may be more portable.
      </li><li>An embedded computer might not even have
      an operating system.
    </li></ul>
  </td>
</tr>
</tbody></table>

<h3>Programming Paradigms and Patterns</h3>

<p>What kind of patterns can you adopt that will help you to produce reliable concurrent
  code? There are too many to mention here, but here are some things to think about:</p>
<ul>
<li>When writing async code, consider futures and promises instead of callbacks.
</li><li>Look at reactive programming.
</li><li>Look at some of the old work, like Hewitt's Actors.
</li><li>Learn a process algebra, like Hoare's CSP or Milner's CCS, to gain a deeper understanding.
</li><li>Look at what <a href="http://www.infoq.com/presentations/Are-We-There-Yet-Rich-Hickey">Rich
  Hickey is doing with time in Clojure</a>.
</li></ul>

<h3>Fault-Tolerance, Scale, Reliability</h3>

<p>This is a big topic. You might like to read about <a href="http://www.erlang.org/">Erlang</a>.</p>

<h3>Correctness</h3>

<p>Concurrent programs have to be correct <em>for all possible
interleavings</em>. Natrually this makes testing more complicated,
but it can be done.</p>

<h2>Further Reading</h2>

<p>We barely scratched the surface. There is so much more to learn.</p>

<h3>Topics</h3>

<p>How about some academic overviews of these fascinating topics.</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Actor_model">Actors</a>
</li><li><a href="http://en.wikipedia.org/wiki/Software_transactional_memory">Software Transactional Memory</a>
</li><li><a href="https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/package-summary.html">Atomic Variables (in Java)</a>
</li><li><a href="http://en.wikipedia.org/wiki/Lock_%28computer_science%29">Locks</a>
</li><li><a href="http://en.wikipedia.org/wiki/Calculus_of_communicating_systems">Milner' CCS</a>
</li><li><a href="http://en.wikipedia.org/wiki/Communicating_sequential_processes">Hoare's CSP</a>
</li><li><a href="http://en.wikipedia.org/wiki/Non-blocking_algorithm">Non-blocking</a>
</li><li><a href="http://en.wikipedia.org/wiki/Thread-local_storage">Thread-Local Storage</a>
</li></ul>

<h3>Language Support</h3>

<p>This is an embarrassingly short and incomplete list:</p>
<ul>
<li><a href="http://docs.oracle.com/javase/tutorial/essential/concurrency/">Java</a>
</li><li>Scala: <a href="https://akka.io/">Actors (Akka)</a>,
    <a href="http://docs.scala-lang.org/overviews/core/futures.html">Futures and Promises</a>,
    <a href="http://docs.scala-lang.org/overviews/parallel-collections/overview.html">Parallel Collections</a>
</li><li><a href="http://clojure.org/concurrent_programming">Clojure</a>
</li><li><a href="http://julia.readthedocs.org/en/latest/manual/parallel-computing/">Julia</a>
</li><li><a href="http://elm-lang.org/learn/What-is-FRP.elm">Elm</a>
</li><li><a href="https://doc.rust-lang.org/book/concurrency.html">Rust</a>
</li><li><a href="http://www.golang-book.com/books/intro/10">Go</a>
</li><li><a href="http://www.erlang.org/">Erlang</a>
</li></ul>

<div class="exercise"><b>Exercise</b>: Rust claims to eliminate data races. How do they do that?
</div>
<script src="Introduction%20to%20Concurrency_files/lang-ada.js"></script>

<h2>Summary</h2><div class="summary"><p>We’ve covered:</p><ul><li>What we mean by concurrency</li><li>Real-world examples (outside of software)</li><li>Architectural choices</li><li>Ways to model processes</li><li>Definitions of some terms</li><li>Why we should study this field</li><li>Granularity, Scheduling, Communication, Synchronization, and more</li><li>Where to find more information</li></ul>
</div>      </div>
    </div>
    <script>
      var title = document.getElementsByTagName("h1")[0];
      if (title) document.title = title.innerHTML;
      var abstract = document.querySelector(".abstract");
      if (abstract) {
        var contentsDiv = document.createElement('div');
        contentsDiv.setAttribute('id', 'contents');
        var s = Array.from(document.getElementsByTagName("h2")).map(el => el.textContent);
        contentsDiv.innerHTML = '<div>CONTENTS</b></div><div>' + s.join(' • ') + '</div>';
        abstract.parentNode.insertBefore(contentsDiv, abstract.nextSibling);
      }
      function makeHidden(element, control) {
        element.style.display = "none";
        control.style.backgroundColor = "green";
        control.innerHTML = "SHOW&nbsp;ANSWER";
      }
      function makeShown(element, control) {
        element.style.display = "block";
        control.style.backgroundColor = "red";
        control.innerHTML = "HIDE&nbsp;ANSWER";
      }
      var elements = document.getElementsByClassName("answer");
      for (var i = 0; i < elements.length; i++) {
        var a = elements[i];
        var link = document.createElement('span');
        link.style.color = "white"
        link.style.fontSize = "75%";
        link.style.fontFamily = "sans-serif"
        link.style.borderRadius = "10px";
        link.style.padding = "2px 8px";
        link.style.marginLeft = "0.1em";
        makeHidden(a, link);
        link.onclick = (function (a, link) {
          return function () {
            if (a.style.display === "none") {
              makeShown(a, link);
            } else {
              makeHidden(a, link);
            }
          }
        }(a, link));
        a.parentNode.insertBefore(link, a);
      }
    </script>
  

<svg style="display: none;" id="MJX-SVG-global-cache"><defs><path id="MJX-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJX-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-TEX-I-1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path><path id="MJX-TEX-I-1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJX-TEX-I-210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJX-TEX-SO-28" d="M152 251Q152 646 388 850H416Q422 844 422 841Q422 837 403 816T357 753T302 649T255 482T236 250Q236 124 255 19T301 -147T356 -251T403 -315T422 -340Q422 -343 416 -349H388Q359 -325 332 -296T271 -213T212 -97T170 56T152 251Z"></path><path id="MJX-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-TEX-SO-29" d="M305 251Q305 -145 69 -349H56Q43 -349 39 -347T35 -338Q37 -333 60 -307T108 -239T160 -136T204 27T221 250T204 473T160 636T108 740T60 807T35 839Q35 850 50 850H56H69Q197 743 256 566Q305 425 305 251Z"></path><path id="MJX-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJX-TEX-I-1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path><path id="MJX-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-TEX-I-1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path id="MJX-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path><path id="MJX-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-TEX-I-1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z"></path><path id="MJX-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-TEX-N-21" d="M78 661Q78 682 96 699T138 716T180 700T199 661Q199 654 179 432T158 206Q156 198 139 198Q121 198 119 206Q118 209 98 431T78 661ZM79 61Q79 89 97 105T141 121Q164 119 181 104T198 61Q198 31 181 16T139 1Q114 1 97 16T79 61Z"></path><path id="MJX-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path><path id="MJX-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-TEX-N-3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></defs></svg></body></html>